<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>WYMeditor</title>
</head>
<body>
    <h1>WYMeditor basic integration example with simple skin customisation</h1>
    <p><a href="http://www.wymeditor.org/">WYMeditor</a> is a web-based XHTML WYSIWYM editor.</p>
    <form method="post" action="">
        <textarea class="wymeditor"></textarea>
        <input type="submit" class="wymupdate" />
    </form>
    <div>More stuff</div>

    <!-- build:js vendor/jquery/jquery.js -->
    <!-- endbuild -->
    <!-- build:js ../wymeditor/jquery.wymeditor.js -->
    <script type="text/javascript" src="../test/load-src.dev.js"></script>
    <script type="text/javascript">
        loadWymSrc('../');
    </script>
    <!-- endbuild -->
    <!-- build:js vendor/iframe-auto-height-jquery-plugin/Src/iframeheight.js -->
    <script type="text/javascript" src="../bower_components/iframe-auto-height-jquery-plugin/Src/iframeheight.js"></script>
    <!-- endbuild -->

    <script type="text/javascript">
        jQuery(function() {
            var stringToRepeat = '<p>Hello, World!<\/p>',
                html = '';

            for (var i = 0; i < 30; i++) {
                html = html + stringToRepeat;
            }
            function resizeIframe(iframe) {
                iframe.height = iframe.contentWindow.document.body.scrollHeight + "px";
            }
            jQuery('.wymeditor').wymeditor({
                html: html,
                skin: 'seamless',
                iframeHtml: String() +
                    '<div class="wym_iframe wym_section">' +
                        '<iframe src="' + WYMeditor.IFRAME_BASE_PATH + 'wymiframe.html" ' +
                            'frameborder="0" ' +
                            'scrolling="no" ' +
                            'onload="this.contentWindow.parent.WYMeditor.INSTANCES[' +
                            WYMeditor.INDEX + '].initIframe(this)"' +
                            '>' +
                        '</iframe>' +
                    "</div>",
                postInit: function(wym) {
                    //WYMeditor.INSTANCES[WYMeditor.INDEX].initIframe($('iframe')[0]);
                //$(wym._iframe).iframeHeight({watcher: true});
                    resizeIframe(wym._iframe);
                    $(wym._doc).bind(
                        WYMeditor.EVENTS.postBlockMaybeCreated,
                        function (e, wym) {
                            resizeIframe(wym._iframe);
                            // Scroll to the current selection
                            var container = wym.selected();
                            var topPos = container.offsetTop;
                            // Scroll the page so that our current selection
                            // within the iframe is actually in view.
                            // TODO: We only actually want to perform the
                            // scroll if the selected content is either off the
                            // screen or almost off the screen. Right now, we're
                            // scrolling much too often, which is disorienting.
                            var $contents = $(wym._iframe).contents();
                            $(document).scrollTop(topPos);
                        }
                    );

                }
            });
        });
    </script>
</body>
</html>
